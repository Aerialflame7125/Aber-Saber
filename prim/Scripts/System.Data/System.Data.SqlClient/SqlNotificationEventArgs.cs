namespace System.Data.SqlClient;

/// <summary>Represents the set of arguments passed to the notification event handler.</summary>
public class SqlNotificationEventArgs : EventArgs
{
	private SqlNotificationType _type;

	private SqlNotificationInfo _info;

	private SqlNotificationSource _source;

	internal static SqlNotificationEventArgs s_notifyError = new SqlNotificationEventArgs(SqlNotificationType.Subscribe, SqlNotificationInfo.Error, SqlNotificationSource.Object);

	/// <summary>Gets a value that indicates whether this notification is generated because of an actual change, or by the subscription.</summary>
	/// <returns>A value indicating whether the notification was generated by a change or a subscription.</returns>
	public SqlNotificationType Type => _type;

	/// <summary>Gets a value that indicates the reason for the notification event, such as a row in the database being modified or a table being truncated.</summary>
	/// <returns>The notification event reason.</returns>
	public SqlNotificationInfo Info => _info;

	/// <summary>Gets a value that indicates the source that generated the notification, such as a change to the query data or the database's state.</summary>
	/// <returns>The source of the notification.</returns>
	public SqlNotificationSource Source => _source;

	/// <summary>Creates a new instance of the <see cref="T:System.Data.SqlClient.SqlNotificationEventArgs" /> object.</summary>
	/// <param name="type">
	///   <see cref="T:System.Data.SqlClient.SqlNotificationType" /> value that indicates whether this notification is generated because of an actual change, or by the subscription.</param>
	/// <param name="info">
	///   <see cref="T:System.Data.SqlClient.SqlNotificationInfo" /> value that indicates the reason for the notification event. This may occur because the data in the store actually changed, or the notification became invalid (for example, it timed out).</param>
	/// <param name="source">
	///   <see cref="T:System.Data.SqlClient.SqlNotificationSource" /> value that indicates the source that generated the notification.</param>
	public SqlNotificationEventArgs(SqlNotificationType type, SqlNotificationInfo info, SqlNotificationSource source)
	{
		_info = info;
		_source = source;
		_type = type;
	}
}
